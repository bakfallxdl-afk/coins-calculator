<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coins Calculator | 硬币计算器</title>
    
    <!-- 核心CSS文件 -->
    <link rel="stylesheet" href="main.css">
    <link rel="stylesheet" href="header-new.css">
    <link rel="stylesheet" href="button.css">
    <link rel="stylesheet" href="theme.css">
    
    <!-- 图标库 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- PWA相关 -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#FF6B35">
</head>
<body>
    <div class="container">
        <!-- 头部区域 -->
        <header class="app-header">
            <div class="header-content">
                <img src="assets/images/header-image.png" alt="Coins Calculator" class="header-image" id="headerImage">
                <div class="header-text" style="display: none;">
                    <h1><i class="fas fa-coins"></i> Coins Calculator</h1>
                    <h2>硬币计算器</h2>
                    <p class="subtitle">轻松计算硬币分配和Roll点</p>
                    <p class="made-by">Made by Bakfall</p>
                </div>
                
                <!-- 星星装饰 -->
                <div class="star">★</div>
                <div class="star">★</div>
                <div class="star">★</div>
                <div class="star">★</div>
            </div>
        </header>

        <!-- 主要内容区域 -->
        <main>
            <!-- 硬币计算卡片 -->
            <div class="card">
                <h2><i class="fas fa-calculator"></i> 硬币计算</h2>
                
                <!-- 玩家名称输入 -->
                <div class="player-name-inputs">
                    <div class="player-name-item">
                        <label for="player1">玩家 1</label>
                        <input type="text" id="player1" class="player-name-input" placeholder="玩家1名称" value="Player 1">
                    </div>
                    <div class="player-name-item">
                        <label for="player2">玩家 2</label>
                        <input type="text" id="player2" class="player-name-input" placeholder="玩家2名称" value="Player 2">
                    </div>
                    <div class="player-name-item">
                        <label for="player3">玩家 3</label>
                        <input type="text" id="player3" class="player-name-input" placeholder="玩家3名称" value="Player 3">
                    </div>
                </div>
                
                <!-- 其他内容区域... -->
                <div class="input-group">
                    <label>总硬币数 <span class="en">(Total Coins)</span></label>
                    <input type="number" id="totalCoins" placeholder="输入总硬币数" min="0">
                </div>
                
                <div class="button-group">
                    <button class="btn-primary" id="calculateBtn">
                        <i class="fas fa-calculator"></i> 计算分配
                    </button>
                    <button class="btn-secondary" id="resetBtn">
                        <i class="fas fa-redo"></i> 重置
                    </button>
                </div>
            </div>

            <!-- Roll点卡片 -->
            <div class="card">
                <h2><i class="fas fa-dice"></i> Roll点系统</h2>
                <div class="roll-section">
                    <button class="btn-image-roll" id="rollBtn">
                        <img src="assets/images/startroll.png" alt="开始Roll点" class="roll-btn-img">
                    </button>
                    
                    <div class="roll-results">
                        <div class="roll-results-list" id="rollResults">
                            <!-- Roll点结果将在这里显示 -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- 结果表格卡片 -->
            <div class="card">
                <h2><i class="fas fa-table"></i> 计算结果</h2>
                <div class="table-container">
                    <table id="resultsTable">
                        <thead>
                            <tr>
                                <th>玩家</th>
                                <th>百分比</th>
                                <th>获得硬币</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- 计算结果将在这里显示 -->
                        </tbody>
                    </table>
                </div>
                
                <div class="summary">
                    <div class="summary-item">
                        <i class="fas fa-users"></i>
                        <span>玩家总数:</span>
                        <strong id="totalPlayers">3</strong>
                    </div>
                    <div class="summary-item">
                        <i class="fas fa-coins"></i>
                        <span>总硬币数:</span>
                        <strong id="displayTotalCoins">0</strong>
                    </div>
                    <div class="summary-item">
                        <i class="fas fa-check-circle"></i>
                        <span>已分配:</span>
                        <strong id="distributedCoins">0</strong>
                    </div>
                </div>
            </div>
        </main>

        <!-- 页脚 -->
        <footer class="app-footer">
            <p>Coins Calculator v2.0 | 硬币计算器</p>
            <p class="instructions">用于计算硬币分配和Roll点结果</p>
            <p><i class="fas fa-copyright"></i> 2024 Bakfall. All rights reserved.</p>
        </footer>
    </div>

    <!-- JavaScript文件 -->
    <script src="script.js"></script>
    
    <!-- PWA Service Worker注册 -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => {
                        console.log('ServiceWorker注册成功:', registration.scope);
                    })
                    .catch(error => {
                        console.log('ServiceWorker注册失败:', error);
                    });
            });
        }
        
        // 头部图片加载处理
        document.addEventListener('DOMContentLoaded', function() {
            const headerImage = document.getElementById('headerImage');
            const headerText = document.querySelector('.header-text');
            
            if (headerImage) {
                headerImage.onload = function() {
                    console.log('头部图片加载成功');
                };
                
                headerImage.onerror = function() {
                    console.log('头部图片加载失败，显示文字');
                    headerText.style.display = 'block';
                };
                
                // 如果图片已经加载完成（从缓存）
                if (headerImage.complete) {
                    if (headerImage.naturalWidth === 0) {
                        headerText.style.display = 'block';
                    }
                }
            }
        });
    </script>
</body>
</html>
